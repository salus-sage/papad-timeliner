#!/usr/bin/env node
const argv = require('optimist').argv;
const util = require('../util');
const chalk = require('chalk');
const makeConfiguration = require('../makeConfig');

util.configurePrettyError(require('pretty-error'));

const cliArguments = process.argv.slice(2);
const metalsmithConfiguration = cliArguments[0]
  ? cliArguments[0] === '--color' ? 'default' : cliArguments[0]
  : 'default';
const destinationPath = argv.destination || process.cwd();

makeConfiguration(metalsmithConfiguration, destinationPath).build(err => {
  if (err) {
    throw err;
  }
  console.log(
    chalk.green('Complete: ') +
      'Metalsmith with ' +
      chalk.magenta(metalsmithConfiguration) +
      ' configuration.'
  );
});
