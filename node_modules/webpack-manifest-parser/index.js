function manifestToAssets(manifest, destination, resolveSource, log) {
  log = log === false || true;
  if (!manifest) {
    return {};
  }
  return Object.keys(manifest).reduce(function(state, filename) {
    const file = manifest[filename];
    const parts = filename.split('.');

    if (parts[parts.length - 1] === 'css') {
      state.styles = state.styles ? state.styles : [];
      state.styles.push(`${destination}/${file}`);
      return state;
    }

    if (parts[parts.length - 1] === 'js') {
      state.scripts = state.scripts ? state.scripts : [];
      state.scripts.push(`${destination}/${file}`);
    }

    const name = parts.slice(0, -1).join();
    if (state[name] && log) {
      console.log('Warning, conflicting asset name: ' + name);
    }

    state[name] = {
      file,
      filename,
      content: resolveSource ? resolveSource(file) : null,
      url: destination + '/' + file,
    };
    return state;
  }, {});
}

module.exports = manifestToAssets;
